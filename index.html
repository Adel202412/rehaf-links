<!doctype html>

<html lang="en" class="scroll-smooth">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>REHAF â€” Links v1.7</title>
  <meta name="description" content="Minimal links hub with info." />
  <meta property="og:title" content="REHAF â€” Links v1.7" />
  <meta property="og:type" content="website" />
  <meta name="theme-color" content="#00453e" />
  <!-- Favicon / tab icon -->
  <link rel="icon" href="/assets/mascot.png" type="image/png" />
  <link rel="apple-touch-icon" href="/assets/mascot.png" />  <script src="https://cdn.tailwindcss.com"></script>  <style>
    :root{
      --bg1: #00ab9a;
      --bg2: #00786c;
      --accent: #00453e;
      --ink: #ffffff;
    }
    body{ background: linear-gradient(160deg, var(--bg1), var(--bg2)); color:var(--ink); font-size: 19px; }
    .card{ background: var(--accent); border: 1.2px solid var(--accent); color: var(--ink); }
    .btn{ background: rgba(255,255,255,.08); border:1.6px solid var(--accent); }
    .btn:hover{ background: rgba(255,255,255,.15); }
    .disabled{ opacity:.55; pointer-events:none; filter: grayscale(0.3); }
    .badge{ font-size:.75em; padding:.15em .55em; border:1px solid #ffffff40; border-radius:.6rem; }
  </style></head>
<body class="min-h-screen antialiased">
  <main class="mx-auto max-w-2xl px-5 py-8 flex flex-col items-center gap-6">
    <!-- Top: Mascot and Logo -->
    <div class="w-56 md:w-72">
      <img src="/assets/mascot.png" alt="Mascot" class="rounded-2xl shadow-lg mx-auto" loading="lazy" />
    </div>
    <div class="w-64 md:w-80">
      <img src="/assets/logo.png" alt="REHAF Logo" class="mx-auto" />
    </div><!-- Language toggle -->
<div class="w-full flex justify-end">
  <button id="langToggle" class="btn rounded-xl px-3 py-2 text-sm">EN / AR</button>
</div>

<!-- Welcome -->
<section class="card rounded-2xl p-4 text-center w-full">
  <p id="welcomeText" class="text-base md:text-lg"></p>
</section>

<!-- Consent sentence -->
<p class="text-sm md:text-base text-center opacity-90 max-w-xl">
  By continuing, you agree that your request may be processed automatically and securely stored for service quality purposes.
</p>

<!-- Buttons -->
<div id="links" class="mt-2 grid gap-3 w-full"></div>

<!-- Vacancies section -->
<section class="card rounded-2xl p-4 w-full">
  <h2 class="text-lg font-bold mb-2">
    <span id="vacTitle"></span>: 
    <span id="todayDate" class="ml-1 text-base opacity-90"></span>
  </h2>
  <ul id="vacList" class="space-y-2"></ul>
  <p id="vacEmpty" class="text-sm opacity-90"></p>
</section>

<!-- Footer -->
<div class="mt-6 border-t border-white/30 pt-4 text-sm opacity-90 flex flex-col items-center gap-2 w-full">
  <p>Â© <span id="year"></span> REHAF.</p>
  <a id="email" href="mailto:Adel.alsoufi.90@gmail.com" class="underline underline-offset-4">Adel.alsoufi.90@gmail.com</a>
</div>

  </main>  <script>
    const CONFIG = {
      version: "v1.7",
      links: [
        { key: "apply_job", url: "https://forms.gle/hCTbFxT2b1V8CE2i7", info: "Apply to join REHAF.", icon: "ðŸ“„" },
        { key: "hire_req", url: "https://forms.gle/ut62zpkXB2kXNLqb6", info: "Request hiring for your business.", icon: "ðŸ§‘â€ðŸ’¼" },
        { key: "consult_req", url: "https://forms.gle/ZfVrurQazxT8z7xL7", info: "Consultant/Other service request.", icon: "ðŸ“" },
        { key: "auto_soon", url: "", info: "Automation Service â€” Coming Soon.", icon: "âš™ï¸", soon: true },
      ],
      vacancies: {
        items: [] // loaded from vacancies.json
      },
      i18n: {
        en: {
          welcome: "Welcome to REHAF. Use the buttons below to request services or apply.",
          vacTitle: "Vacancies open for today",
          vacEmpty: "No vacancies available at the moment.",
          links: {
            apply_job: { label: "Apply for a Job" },
            hire_req: { label: "Hiring Service Request" },
            consult_req: { label: "Other Service Request (Consultant Service)" },
            auto_soon: { label: "Automation Service (Soon)" }
          }
        },
        ar: {
          welcome: "Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨ÙƒÙ… ÙÙŠ REHAF. Ø§Ø³ØªØ®Ø¯Ù… Ø§Ù„Ø£Ø²Ø±Ø§Ø± Ø£Ø¯Ù†Ø§Ù‡ Ù„Ø·Ù„Ø¨ Ø§Ù„Ø®Ø¯Ù…Ø§Øª Ø£Ùˆ Ø§Ù„ØªÙ‚Ø¯ÙŠÙ….",
          vacTitle: "Ø§Ù„ÙˆØ¸Ø§Ø¦Ù Ø§Ù„Ù…ØªØ§Ø­Ø© Ø§Ù„ÙŠÙˆÙ…",
          vacEmpty: "Ù„Ø§ ØªÙˆØ¬Ø¯ ÙˆØ¸Ø§Ø¦Ù Ù…ØªØ§Ø­Ø© Ø­Ø§Ù„ÙŠØ§Ù‹.",
          links: {
            apply_job: { label: "Ø§Ù„ØªÙ‚Ø¯Ù… Ù„ÙˆØ¸ÙŠÙØ©" },
            hire_req: { label: "Ø·Ù„Ø¨ ØªÙˆØ¸ÙŠÙ" },
            consult_req: { label: "Ø·Ù„Ø¨ Ø®Ø¯Ù…Ø© Ø£Ø®Ø±Ù‰ (Ø§Ø³ØªØ´Ø§Ø±Ø§Øª)" },
            auto_soon: { label: "Ø®Ø¯Ù…Ø© Ø§Ù„Ø£ØªÙ…ØªØ© (Ù‚Ø±ÙŠØ¨Ù‹Ø§)" }
          }
        }
      }
    };

    const $ = s => document.querySelector(s);
    const state = { lang: 'en' };

    const DUBAI_TZ = 'Asia/Dubai';
    function todayFormatted(lang){
      const now = new Date();
      const opts = { day: '2-digit', month: '2-digit', year: 'numeric', timeZone: DUBAI_TZ };
      return new Intl.DateTimeFormat(lang === 'ar' ? 'ar-EG' : 'en-GB', opts).format(now);
    }

    async function loadVacancies(){
      try {
        const res = await fetch('/vacancies.json?v=' + Date.now());
        if(!res.ok) throw new Error('Failed');
        const data = await res.json();
        CONFIG.vacancies.items = Array.isArray(data.items) ? data.items : [];
      } catch(e){
        CONFIG.vacancies.items = [];
      }
    }

    function t(path){
      const parts = path.split('.');
      let curr = CONFIG.i18n[state.lang];
      for(const k of parts){ if(!curr) break; curr = curr[k]; }
      return curr || path;
    }

    function render(){
      // dir
      document.documentElement.setAttribute('dir', state.lang === 'ar' ? 'rtl' : 'ltr');

      // year
      $('#year').textContent = new Date().getFullYear();

      // welcome text
      $('#welcomeText').textContent = t('welcome');

      // buttons
      const wrap = $('#links'); wrap.innerHTML = '';
      CONFIG.links.forEach(l=>{
        const a = document.createElement('a');
        a.href = l.url || '#'; a.target = l.url ? '_blank' : '' ; a.rel = l.url ? 'noopener' : '';
        a.className = 'btn rounded-2xl p-4 block transition';
        const label = t(`links.${l.key}.label`);
        const soonBadge = l.soon ? `<span class=\"badge ml-2\">${state.lang==='ar'?'Ù‚Ø±ÙŠØ¨Ù‹Ø§':'Soon'}</span>` : '';
        a.innerHTML = `<div class=\"flex items-center gap-3\">\n          <div class=\"h-10 w-10 rounded-xl grid place-items-center text-xl bg-white/10\">${l.icon||'ðŸ”—'}</div>\n          <div class=\"flex-1\">\n            <div class=\"font-semibold text-xl\">${label} ${soonBadge}</div>\n            <div class=\"text-base opacity-90\">${l.info||''}</div>\n          </div>\n        </div>`;
        if(l.soon){ a.classList.add('disabled'); a.removeAttribute('href'); }
        wrap.appendChild(a);
      });

      // vacancies title + date
      $('#vacTitle').textContent = t('vacTitle');
      $('#todayDate').textContent = todayFormatted(state.lang);

      // vacancies list
      const list = $('#vacList'); list.innerHTML = '';
      if(CONFIG.vacancies.items && CONFIG.vacancies.items.length){
        $('#vacEmpty').textContent = '';
        CONFIG.vacancies.items.forEach(v=>{
          const title = state.lang==='ar' ? (v.title_ar || v.title_en) : (v.title_en || v.title_ar);
          const meta  = state.lang==='ar' ? (v.meta_ar || '') : (v.meta_en || '');
          const li = document.createElement('li');
          li.innerHTML = `<div class=\"flex items-center gap-2\">\n            <span class=\"opacity-80\">-</span>\n            <span class=\"text-base\">${title}</span>\n            <span class=\"text-sm opacity-70 ml-auto\">${meta}</span>\n          </div>`;
          list.appendChild(li);
        });
      } else {
        $('#vacEmpty').textContent = t('vacEmpty');
      }
    }

    // initial render AFTER loading vacancies
    loadVacancies().then(render);

    // toggle language
    $('#langToggle').addEventListener('click', ()=>{
      state.lang = state.lang === 'en' ? 'ar' : 'en';
      render();
    });
  </script>
<script src="https://cdn.jsdelivr.net/npm/rasa-webchat/lib/index.min.js"></script>
<script>
  WebChat.default.init({
    selector: "#webchat",
    initPayload: "/greet",
    customData: { language: "en" }, // we will also add "ar" later
    socketUrl: "http://localhost:5005", // temporary, we will fix later
    title: "REHAF Assistant",
    subtitle: "Business Solution Provider",
    profileAvatar: "/assets/logo.png",
    showCloseButton: true,
    showFullScreenButton: true,
    showMessageDate: true,
    inputTextFieldHint: "Type your question..."
  });
</script>

</body>
</html>
